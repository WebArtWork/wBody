import{a as S}from"./chunk-RGJDTYJU.js";import{a as F}from"./chunk-ZRSPFHTT.js";import{e as C}from"./chunk-UT4SC3IQ.js";import{C as a,F as h,G as f,L as u,Qa as _,R as p,Xa as y,c as n,cb as b,hb as w,m,ob as v,qb as g}from"./chunk-3ODZ3UFP.js";import{g as c}from"./chunk-GAL4ENT6.js";var M=(()=>{class r{constructor(o,i,t,s,d){this._translate=o,this._bodyService=i,this._alert=t,this._form=s,this._core=d,this.columns=["name","description"],this.form=this._form.getForm("body",S),this.config={paginate:this.setRows.bind(this),perPage:20,setPerPage:this._bodyService.setPerPage.bind(this._bodyService),allDocs:!1,create:()=>{this._form.modal(this.form,{label:"Create",click:(e,l)=>c(this,null,function*(){l(),this._preCreate(e),yield n(this._bodyService.create(e)),this.setRows()})})},update:e=>{this._form.modal(this.form,[],e).then(l=>{this._core.copy(l,e),this._bodyService.update(e)})},delete:e=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this body?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>c(this,null,function*(){yield n(this._bodyService.delete(e)),this.setRows()})}]})},buttons:[{icon:"fitness_center",hrefFunc:e=>"/bodyexercise/"+e._id},{icon:"fastfood",hrefFunc:e=>"/bodyfood/"+e._id},{icon:"calendar_today",hrefFunc:e=>"/bodyhabit/"+e._id},{icon:"mood",hrefFunc:e=>"/bodymood/"+e._id},{icon:"bedtime",hrefFunc:e=>"/bodysleep/"+e._id},{icon:"flag",hrefFunc:e=>"/bodytarget/"+e._id},{icon:"self_improvement",hrefFunc:e=>"/bodystress/"+e._id},{icon:"monitor_weight",hrefFunc:e=>"/bodyweight/"+e._id},{icon:"cloud_download",click:e=>{this._form.modalUnique("body","url",e)}}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]},this.rows=[],this._page=1,this.setRows()}setRows(o=this._page){this._page=o,this._core.afterWhile(this,()=>{this._bodyService.get({page:o}).subscribe(i=>{this.rows.splice(0,this.rows.length),this.rows.push(...i)})},250)}_bulkManagement(o=!0){return()=>{this._form.modalDocs(o?[]:this.rows).then(i=>c(this,null,function*(){if(o)for(let t of i)this._preCreate(t),yield n(this._bodyService.create(t));else{for(let t of this.rows)i.find(s=>s._id===t._id)||(yield n(this._bodyService.delete(t)));for(let t of i){let s=this.rows.find(d=>d._id===t._id);s?(this._core.copy(t,s),yield n(this._bodyService.update(s))):(this._preCreate(t),yield n(this._bodyService.create(t)))}}this.setRows()}))}}_preCreate(o){delete o.__created}static{this.\u0275fac=function(i){return new(i||r)(a(w),a(F),a(b),a(g),a(y))}}static{this.\u0275cmp=h({type:r,selectors:[["ng-component"]],standalone:!1,decls:1,vars:3,consts:[["title","Body",3,"columns","config","rows"]],template:function(i,t){i&1&&p(0,"wtable",0),i&2&&u("columns",t.columns)("config",t.config)("rows",t.rows)},dependencies:[v],encapsulation:2})}}return r})();var B=[{path:"",component:M}],W=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=f({type:r})}static{this.\u0275inj=m({imports:[_.forChild(B),C]})}}return r})();export{W as BodyModule};
